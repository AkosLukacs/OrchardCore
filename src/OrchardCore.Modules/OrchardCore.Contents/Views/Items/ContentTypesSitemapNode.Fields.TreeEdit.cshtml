@using OrchardCore.Sitemaps.Models
@model ContentTypesSitemapNodeViewModel

<style asp-src="~/OrchardCore.Contents/Styles/Contents.min.css" debug-src="~/OrchardCore.Contents/Styles/Contents.css"></style>

<h5>@T["Content Types"]</h5>


<div class="row">
    <div class="col col-xl-9">

        @*Panel Switcher*@
        <div class="form-group form-check">
            <input asp-for="IndexAll" class="form-check-input" id="ContentTypesSitemapNode_IndexAll" />
            <label asp-for="IndexAll" class="form-check-label">@T["Index All Content Types"]</label>
        </div>

        @*Index All Panel*@
        <div id="index-all-card" class="card mb-4 @(Model.IndexAll ? "" : "collapse")">
            <div class="card-header">
                @T["Index All Content Types"]
            </div>
            <div class="card-body">
                <div class="form-group" asp-validation-class-for="ChangeFrequency">
                    <label asp-for="ChangeFrequency">@T["Change Frequency"] </label>
                    <select asp-for="ChangeFrequency" class="form-control w-25" asp-items="Html.GetEnumSelectList<ChangeFrequency>()"></select>
                    <span class="hint">@T["The default frequency these content types are likely to change."]</span>
                </div>
                <div class="form-group" asp-validation-class-for="IndexPriority">
                    <label asp-for="IndexPriority">@T["Index Priority"] </label>
                    <select asp-for="IndexPriority" class="form-control w-25">
                        <option value="0.0">0.0</option>
                        <option value="0.1">0.1</option>
                        <option value="0.2">0.2</option>
                        <option value="0.3">0.3</option>
                        <option value="0.4">0.4</option>
                        <option value="0.5">0.5</option>
                        <option value="0.6">0.6</option>
                        <option value="0.7">0.7</option>
                        <option value="0.8">0.8</option>
                        <option value="0.9">0.9</option>
                        <option value="1.0">1.0</option>
                    </select>
                    <span class="hint">@T["The default priority of these content types relative to other content on your site."]</span>
                </div>
            </div>
        </div>

        @*Index Selected Panel*@
        <div id="index-selected-card" class="card mb-4 @(Model.IndexAll ? "collapse" : "")">
            <div class="card-header">
                @T["Select Content Types"]
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <ul class="list-group">
                            @for (int i = 0; i < Model.ContentTypes.Count(); i++)
                            {
                                var name = Model.ContentTypes[i].ContentTypeId;
                                var checkd = Model.ContentTypes[i].IsChecked;
                                var notChecked = !checkd;
                                <li class="list-group-item d-flex @(checkd ? "" : "disabled")">
                                    <input type="hidden" name="@Html.NameFor(m => m.ContentTypes[i].ContentTypeId)"
                                           value="@Model.ContentTypes[i].ContentTypeId" />
                                    <div class="flex-grow-1 align-self-center">
                                        <div class="form-check">
                                            <label class="form-check-label">
                                                <input asp-for="ContentTypes[i].IsChecked" class="content-type-checkbox" />
                                                @name
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-group pr-3 w-25" asp-validation-class-for="ChangeFrequency">
                                        <label asp-for="ContentTypes[i].ChangeFrequency">@T["Change Frequency"] </label>
                                        <select asp-for="ContentTypes[i].ChangeFrequency" class="form-control" asp-items="Html.GetEnumSelectList<ChangeFrequency>()" disabled="@notChecked"></select>
                                        <span class="hint">@T["The default frequency these content types are likely to change."]</span>
                                    </div>
                                    <div class="form-group w-25" asp-validation-class-for="IndexPriority">
                                        <label asp-for="ContentTypes[i].IndexPriority">@T["Index Priority"] </label>
                                        <select asp-for="ContentTypes[i].IndexPriority" class="form-control" disabled="@notChecked">
                                            <option value="0.0">0.0</option>
                                            <option value="0.1">0.1</option>
                                            <option value="0.2">0.2</option>
                                            <option value="0.3">0.3</option>
                                            <option value="0.4">0.4</option>
                                            <option value="0.5">0.5</option>
                                            <option value="0.6">0.6</option>
                                            <option value="0.7">0.7</option>
                                            <option value="0.8">0.8</option>
                                            <option value="0.9">0.9</option>
                                            <option value="1.0">1.0</option>
                                        </select>
                                        <span class="hint">@T["The default priority of these content types relative to other content on your site."]</span>
                                    </div>
                                </li>
                            }
                        </ul>
                        <span class="hint">@T["The content types to add to the sitemap."]</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script at="Foot" depends-on="jquery">
    $(function () {
        switchContentTypesCheckBoxes();

        $('#ContentTypesSitemapNode_IndexAll').change(function () {
            switchContentTypesCheckBoxes();
        });

        function switchContentTypesCheckBoxes() {
            var indexAll = $('#ContentTypesSitemapNode_IndexAll').prop('checked');

            if (indexAll) {
                $('#index-all-card').show();
                $('#index-selected-card').hide();
            } else {
                $('#index-all-card').hide();
                $('#index-selected-card').show();
            }
        }


        $('.content-type-checkbox').on('click', function (e) {
            var listItem = $(e.target).closest('.list-group-item');

            var selected = $(e.target).prop('checked');
            selected ? listItem.removeClass('disabled') : listItem.addClass('disabled');
            var selects = $(listItem).find('select').each(function () {
                selected ? $(this).prop('disabled', false) : $(this).prop('disabled', 'disabled');
            });
        });
    });
</script>

