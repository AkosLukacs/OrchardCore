
@using OrchardCore.Sitemaps.Models
@model ContentTypesSitemapNodeViewModel

<style asp-src="~/OrchardCore.Contents/Styles/Contents.min.css" debug-src="~/OrchardCore.Contents/Styles/Contents.css"></style>

<h5>@T["Content Types"]</h5>


<div class="row">
    <div class="col col-xl-9">

        @*Panel Switcher*@
        <div class="form-group form-check">
            <input asp-for="IndexAll" class="form-check-input" id="ContentTypesSitemapNode_IndexAll" />
            <label asp-for="IndexAll" class="form-check-label">@T["Index All Content Types"]</label>
        </div>

        @*Index All Panel*@
        <div id="index-all-card" class="card mb-4 @(Model.IndexAll ? "" : "collapse")">
            <div class="card-header">
                @T["Index All Content Types"]
            </div>
            <div class="card-body">
                <div class="form-group" asp-validation-class-for="ChangeFrequency">
                    <label asp-for="ChangeFrequency">@T["Change Frequency"] </label>
                    <select asp-for="ChangeFrequency" class="form-control" asp-items="Html.GetEnumSelectList<ChangeFrequency>()"></select>
                    <span class="hint">@T["The default frequency these content types are likely to change."]</span>
                </div>
                <div class="form-group" asp-validation-class-for="IndexPriority">
                    <label asp-for="IndexPriority">@T["Index Priority"] </label>
                    <input asp-for="IndexPriority" class="form-control content-preview-text" />
                    <span class="hint">@T["The default priority of these content types relative to other content on your site. Valid values range from 0.0 to 1.0."]</span>
                </div>
            </div>
        </div>

        @*Index Selected Panel*@
        <div id="index-selected-card" class="card mb-4 @(Model.IndexAll ? "collapse" : "")">
            <div class="card-header">
                @T["Select Content Types"]
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <ul class="list-group">
                            @for (int i = 0; i < Model.ContentTypes.Count(); i++)
                            {
                                var name = Model.ContentTypes[i].ContentTypeId;
                                var checkd = Model.ContentTypes[i].IsChecked;
                            <li class="list-group-item d-flex align-items-center  @(checkd ? "" : "disabled")">
                                <input type="hidden" name="@Html.NameFor(m => m.ContentTypes[i].ContentTypeId)"
                                       value="@Model.ContentTypes[i].ContentTypeId" />
                                <div class="flex-grow-1">
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input asp-for="ContentTypes[i].IsChecked" class="content-type-checkbox" />
                                            @name
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group" asp-validation-class-for="ChangeFrequency">
                                    <label asp-for="ChangeFrequency">@T["Change Frequency"] </label>
                                    <select asp-for="ChangeFrequency" class="form-control" asp-items="Html.GetEnumSelectList<ChangeFrequency>()"></select>
                                    <span class="hint">@T["The default frequency these content types are likely to change."]</span>
                                </div>
                                <div class="form-group" asp-validation-class-for="IndexPriority">
                                    <label asp-for="IndexPriority">@T["Index Priority"] </label>
                                    <input asp-for="IndexPriority" class="form-control content-preview-text" />
                                    <span class="hint">@T["The default priority of these content types relative to other content on your site. Valid values range from 0.0 to 1.0."]</span>
                                </div>
                            </li>
                            }
                        </ul>
                        <span class="hint">@T["The content types to add to the sitemap."]</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script at="Foot" depends-on="jquery">
    $(function () {
        switchContentTypesCheckBoxes();

        $('#ContentTypesSitemapNode_IndexAll').change(function () {
            switchContentTypesCheckBoxes();
        });

        function switchContentTypesCheckBoxes() {
            var indexAll = $('#ContentTypesSitemapNode_IndexAll').prop('checked');

            if (indexAll) {
                $('#index-all-card').show();
                $('#index-selected-card').hide();
            } else {
                $('#index-all-card').hide();
                $('#index-selected-card').show();
            }
        }


        $('.content-type-checkbox').on('click', function (e) {
            var listItem = $(e.target).closest('.list-group-item');

            var selected = $(e.target).prop('checked');
            selected ? listItem.removeClass('disabled') : listItem.addClass('disabled');

        });

        $('button.remove-icon').on('click', function (e) {
            var node = $(e.target).data('related-node');
            $('#' + node).val('');
            //$('#sample-icon-' + node).replaceWith('<i id="sample-icon-' + node + '" class=" "></i>'); // changing the class is not enough.
        });
    });
</script>

